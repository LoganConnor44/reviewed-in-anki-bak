(this["webpackJsonpreviewed-in-anki"]=this["webpackJsonpreviewed-in-anki"]||[]).push([[0],{33:function(e,n,t){},55:function(e,n,t){e.exports=t(84)},84:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),o=t(8),i=t.n(o),c=(t(33),t(14)),s=t.n(c),l=t(25),u=t(16),d=t(17),f=t(42),p=t.n(f),m=(t(61),function(e){return e[Math.floor(e.length*Math.random())]}),v=function(e){return 5e3*e},h=function(e){var n,t=e.purpose,r=e.delay,o=e.cardText,i=t+"-cell",c="loading"===t,s={backgroundColor:m(["#ff3031","#68ac0d","#00a8da","#fbc500"])},l=function(e,n){var t={},r=m(["horizontal","vertical"]),a=[],o=v(n);if("horizontal"===r){a=[{name:"slide-left-to-center",css:{left:"-100%"}},{name:"slide-right-to-center",css:{right:"-100%"}}]}if("vertical"===r){a=[{name:"slide-top-to-center",css:{top:"-100%"}},{name:"slide-bottom-to-center",css:{bottom:"-100%"}}]}if(!e){var i=m(a),c=o+"ms";t=Object(d.a)(Object(d.a)({},i.css),{position:"absolute",WebkitAnimationName:i.name,WebkitAnimationDuration:"500ms",WebkitAnimationTimingFunction:"ease-out",WebkitAnimationDelay:c,WebkitAnimationIterationCount:1,WebkitAnimationDirection:"normal, normal",WebkitAnimationFillMode:"forwards, forwards",animationName:i.name,animationDuration:"500ms",animationTimingFunction:"ease-out",animationDelay:c,animationIterationCount:1,animationDirection:"normal",animationFillMode:"forwards"})}return t}(c,r),u=Object(d.a)(Object(d.a)(Object(d.a)({},s),l),{width:"100%",height:"100%"}),f=Object(d.a)(Object(d.a)({},s),{top:"50%",height:"50%",position:"absolute",font:"bold 1em/1 'Helvetica Neue', Helvetica, Arial, sans-serif",fontSize:"3em",letterSpacing:"-0.05em",color:"#fff",textShadow:"0 0.1em 0 rgba(0, 0, 0, 0.1)",textDecoration:"none",left:"0.5em",right:"0.5em"}),h=c?(n=t).charAt(0).toUpperCase()+n.slice(1)+"...":o,g=!c,b=v(r)+500;return a.a.createElement("div",{id:i,style:u},a.a.createElement("div",{style:f},a.a.createElement(p.a,{startDelay:b,cursor:{blink:!0,hideWhenDone:g,hideWhenDoneDelay:0}},h)))},g=t(31),b=t.n(g),w=t(43),y=t(50),k=t(49),E=function(e){Object(y.a)(t,e);var n=Object(k.a)(t);function t(){var e;return Object(w.a)(this,t),(e=n.call(this,"ReviewedDb")).reviews=void 0,e.preferences=void 0,e.version(1).stores({reviews:"++id",preferences:"++id"}),e.reviews=e.table("reviews"),e.preferences=e.table("preferences"),e}return t}(t(44).a),j=t(103),x=t(105),O=t(46),A=t.n(O),D=t(48),C=t.n(D),S=t(104),W=t(47),N=t.n(W),R=function(e){var n=Object(r.useState)(!1),t=Object(u.a)(n,2),a=t[0],o=t[1],i=function(n){if(0===n){e.preferences.put({username:"loganconnor44",promptUserForInstallation:!0})}};return Object(r.useEffect)((function(){e.preferences.count().then(i);var n=function(e){e.preventDefault(),o(e)};return window.addEventListener("beforeinstallprompt",n),function(){window.removeEventListener("beforeinstallprompt",n)}}),[]),[a,function(){return a?a.prompt():Promise.reject(new Error('Tried installing before browser sent "beforeinstallprompt" event'))}]},F=function(e){var n=e.database,t=R(n),o=Object(u.a)(t,2),i=o[0],c=o[1],s=Object(r.useState)(!1),l=Object(u.a)(s,2),d=l[0],f=l[1],p=Object(r.useState)(!1),m=Object(u.a)(p,2),v=m[0],h=m[1],g=function(){return f(!1)},b=function(e){e.preventDefault(),n.preferences.toArray().then((function(e){n.preferences.update(e[0].id,{promptUserForInstallation:!1})}))};n.preferences.toArray().then((function(e){0!==e.length&&h(e[0].promptUserForInstallation)})),Object(r.useEffect)((function(){console.log("inThe effect use"),!1!==i&&i&&v&&(console.log("in"),f(!0))}),[i,v]);return d?a.a.createElement(j.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:d,autoHideDuration:3e3},a.a.createElement(x.a,{message:a.a.createElement("div",{style:{display:"flex",alignItems:"center"}},a.a.createElement(A.a,{style:{marginRight:4}}),"Click here to download this app."),style:{backgroundColor:"#43a047"},action:a.a.createElement("div",null,a.a.createElement(S.a,{key:"download-and-dismiss","aria-label":"download-and-dismiss",onClick:function(){g(),c()}},a.a.createElement(N.a,null)),a.a.createElement(S.a,{key:"close","aria-label":"close",onClick:function(e){g(),b(e)}},a.a.createElement(C.a,null)))})):a.a.createElement("div",null)},T=function(){var e=new E,n=Object(r.useState)([]),t=Object(u.a)(n,2),o=t[0],i=t[1];Object(r.useEffect)((function(){var n=function(){var e=Object(l.a)(s.a.mark((function e(n){var r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("retrieveDataFromAnkiApi :: Starting function"),r=[],a={action:"findNotes",version:6,params:{query:"rated:7"}},e.next=5,b.a.post("http://192.168.1.4:8765",a).then((function(e){return n>0&&n===e.data.result.length?(console.log("retrieveDataFromAnkiApi :: Exiting function :: Same records exist in IndexedDb"),["same-records"]):0===n?["No cards studied today.","Nothing found.","Perform a sync if you are expecting results.","Looks like you've been lazy."]:(console.log("retrieveDataFromAnkiApi :: Exiting function :: Proceed to processCardsReviewed"),t(e,r))}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),t=function(){var e=Object(l.a)(s.a.mark((function e(n,t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("processCardsReviewed :: Starting function"),"undefined"!==typeof n.data.result&&0!==n.data.result.length){e.next=4;break}return console.log("processCardsReviewed :: Exiting function :: No cards returned"),e.abrupt("return",t);case 4:return a={action:"notesInfo",version:6,params:{notes:n.data.result}},e.next=7,b.a.post("http://192.168.1.4:8765",a).then((function(e){return console.log("processCardsReviewed :: Exiting function :: Proceed to processDetailedCardsReviewed"),r(e,t)}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),r=function(){var e=Object(l.a)(s.a.mark((function e(n,t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("processDetailedCardsReviewed :: Starting function"),"undefined"!==typeof n.data.result&&n.data.result.forEach((function(e){"undefined"!==typeof e.fields.Hanzi&&t.push(e.fields.Hanzi.value),"undefined"!==typeof e.fields["Simplified Hanzi"]&&t.push(e.fields["Simplified Hanzi"].value)})),0===t.length&&(console.log("No data returned."),t.push("No cards studied today."),t.push("Nothing found."),t.push("Perform a sync if you are expecting results."),t.push("Looks like you've been lazy.")),console.log("processDetailedCardsReviewed :: Exiting function"),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}();(function(){var t=Object(l.a)(s.a.mark((function t(){var r,o,c,l;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("getAnkiData :: Starting function"),o=[],t.next=4,e.reviews.toArray();case 4:return l=t.sent,t.next=7,n(l.length);case 7:"same-records"!==(o=t.sent)[0]?(c=o.map((function(e){return{createdTimestamp:Date.now(),displayContent:e}})),e.reviews.clear(),e.reviews.bulkAdd(c),r=c.map((function(e,n){return a.a.createElement(h,{key:n,purpose:"content",delay:n,cardText:e.displayContent})}))):r=l.map((function(e,n){return a.a.createElement(h,{key:e.id,purpose:"content",delay:n,cardText:e.displayContent})})),i(r),console.log("getAnkiData :: Exiting function");case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[]);var c=a.a.createElement(h,{key:99999,purpose:"loading",delay:0,cardText:""});return a.a.createElement(r.Fragment,null,a.a.createElement(F,{database:e}),c,o.length<1?a.a.createElement("div",{hidden:!0}):o.map((function(e){return e})))},z=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function I(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(a.a.createElement(T,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/reviewed-in-anki",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("/reviewed-in-anki","/service-worker.js");z?(!function(e,n){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var r=t.headers.get("content-type");404===t.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):I(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):I(n,e)}))}}()}},[[55,1,2]]]);
//# sourceMappingURL=main.049bdb8b.chunk.js.map